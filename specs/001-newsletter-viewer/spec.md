# 功能規格書：電子報閱讀 CMS Web App

**功能分支**: `001-newsletter-viewer`
**建立日期**: 2025-10-28
**狀態**: 草稿
**使用者描述**: 建立一個 CMS Web App，用作查看 Email Newsletter 的詳細內容。需要以每週的方式查看數篇文章。每一章的文章之间要有快速导航方法，例如在畫面的左右邊緣有按鈕。每一篇文章有獨立的連結，提供给电邮。使用連結能直接打開文章，導航亦能清楚當前位置。在頂部工具列亦有按鈕，可以前後切換文章。在編輯每週的內容時，可以修改及設定文章的順序。

## 使用者場景與測試 *(必須)*

### 使用者故事 1 - 查看週報文章內容 (優先級: P1)

讀者訪問電子報網站，希望查看特定週份的所有文章。他們需要能夠輕鬆地瀏覽該週的多篇文章，並迅速在文章之間導航，同時能清晰地了解自己在整個週報中的位置。

**優先級原因**: 這是最核心的功能，是電子報 CMS 的基本價值——允許讀者訪問和瀏覽內容。沒有此功能，應用程式無法提供任何價值。

**獨立測試**: 可以通過導航到週報頁面、查看文章清單、在多篇文章之間切換，並驗證導航控制項正常運作來完整測試此故事。無需其他功能即可驗證。

**驗收場景**:

1. **Given** 讀者訪問電子報網站，**When** 他們選擇查看特定週份（例如：第 42 週），**Then** 系統顯示該週的所有文章清單及第一篇文章的詳細內容

2. **Given** 讀者正在查看某篇文章，**When** 他們點擊右邊的導航按鈕或在工具列中點擊下一篇，**Then** 應用程式顯示下一篇文章的內容並更新導航位置指示器

3. **Given** 讀者正在查看某篇文章，**When** 他們點擊左邊的導航按鈕或在工具列中點擊上一篇，**Then** 應用程式顯示上一篇文章的內容並更新導航位置指示器

4. **Given** 讀者在閱讀文章中途，**When** 他們查看頁面元素，**Then** 系統清楚地顯示當前文章位置（例如：「第 5 篇，共 10 篇」）

5. **Given** 讀者正在查看週報，**When** 他們嘗試點擊已在最後一篇文章且按下下一篇按鈕，**Then** 系統禁用下一篇按鈕或顯示提示，防止超出邊界

---

### 使用者故事 2 - 通過直接連結訪問特定文章 (優先級: P1)

讀者通過電子郵件或其他來源收到指向特定文章的連結。他們點擊連結後，應用程式應直接打開該文章，無需手動導航，並清楚顯示該文章在週報中的位置。

**優先級原因**: 這是與電子報整合的關鍵功能。允許在電子郵件中嵌入直接連結，提升用戶體驗和轉換率。與故事 1 同等重要，因為它提供核心訪問路徑。

**獨立測試**: 可以通過生成特定文章的唯一連結、在瀏覽器中訪問該連結、驗證正確的文章是否顯示及導航狀態是否正確來完整測試。

**驗收場景**:

1. **Given** 讀者有指向特定文章的唯一 URL（例如：`/newsletter/2025-w42/article/5`），**When** 他們在瀏覽器中訪問該 URL，**Then** 應用程式直接顯示該篇文章及其完整內容

2. **Given** 讀者通過直接連結訪問文章，**When** 頁面完全加載時，**Then** 導航位置指示器清楚地顯示該文章在週報中的位置（例如：「第 5 篇，共 10 篇」）

3. **Given** 讀者通過直接連結訪問特定周份中的某篇文章，**When** 文章加載完成，**Then** 讀者能夠使用所有導航方法（左右按鈕、工具列、文章清單）在同一週內的其他文章之間導航

4. **Given** 讀者訪問的連結指向不存在的文章或周份，**When** 頁面嘗試加載，**Then** 系統顯示友善的錯誤信息及返回首頁或最近周份的選項

---

### 使用者故事 3 - 快速導航文章 (優先級: P2)

讀者希望能夠快速地在文章之間移動，無需等待或進行額外操作。系統應提供多種便利的導航方法，以適應不同的使用習慣。

**優先級原因**: 這提升使用者體驗和效率，使瀏覽感覺流暢。雖然重要，但不如核心閱讀功能（P1）緊迫。

**獨立測試**: 可以通過使用不同導航方法（邊緣按鈕、工具列按鈕、鍵盤快捷鍵）連續切換文章並驗證所有方法都能產生相同結果來測試。

**驗收場景**:

1. **Given** 讀者正在查看文章，**When** 他們點擊螢幕左邊的上一篇按鈕，**Then** 立即顯示上一篇文章（無重新加載動畫或延遲）

2. **Given** 讀者正在查看文章，**When** 他們點擊螢幕右邊的下一篇按鈕，**Then** 立即顯示下一篇文章（無重新加載動畫或延遲）

3. **Given** 讀者正在查看文章，**When** 他們在頂部工具列中點擊上一篇或下一篇按鈕，**Then** 頁面導航至相應文章

4. **Given** 讀者希望快速瀏覽多篇文章，**When** 他們重複點擊導航按鈕，**Then** 所有文章在 1 秒內完成加載並顯示

---

### 使用者故事 4 - 管理周報內容順序 (優先級: P3)

編輯或內容管理者需要管理每週的電子報內容。他們應該能夠新增、刪除或重新排列該週內的文章，以確保最佳的呈現順序。

**優先級原因**: 這是內容管理功能，支援編輯工作流。雖然重要，但讀者端功能（P1、P2）應優先實現。此功能提供管理效率，但不直接影響讀者價值。

**獨立測試**: 可以通過進入編輯模式、修改文章順序、驗證變更是否保存及前端是否反映這些變更來測試。

**驗收場景**:

1. **Given** 編輯者進入周報編輯介面，**When** 他們查看某週的文章清單，**Then** 系統顯示可拖拽或可重新排列的文章清單

2. **Given** 編輯者想要改變文章順序，**When** 他們拖拽文章或使用上下按鈕重新排列，**Then** 系統實時更新順序預覽

3. **Given** 編輯者完成了順序調整，**When** 他們點擊保存按鈕，**Then** 變更被保存，讀者端隨後可以看到新的文章順序

4. **Given** 編輯者想移除某篇文章，**When** 他們點擊刪除按鈕，**Then** 系統請求確認，刪除後該文章從週報中移除

---

### 邊界情況

- 如果某周沒有任何文章會發生什麼？系統應顯示友善信息「此週暫無文章」。
- 如果文章標題或內容非常長會如何顯示？系統應適當截斷或使用換行，確保不破壞佈局。
- 如果讀者訪問的周份不存在（例如：未來的周份）會怎樣？系統應顯示 404 錯誤或建議查看最新可用週份。
- 如果文章在編輯中被刪除，而讀者已打開該文章連結會發生什麼？系統應顯示「文章已移除」的適當消息。
- 系統如何處理多個編輯者同時編輯同一週的內容？系統不主動處理衝突；最後保存的變更會覆蓋前一次編輯。編輯者應協調以避免衝突。
- 文章切換期間載入時間過長會怎樣？系統應顯示載入指示器（旋轉圖標），隱藏舊內容直到新文章完全加載，提供清晰的進度反饋。

## 需求 *(必須)*

### 功能需求

- **FR-001**: 系統 MUST 允許讀者查看特定週份的所有文章清單
- **FR-002**: 系統 MUST 提供在同一週的文章之間前後導航的功能（上一篇/下一篇）
- **FR-003**: 系統 MUST 在螢幕左右兩邊提供導航按鈕以切換文章
- **FR-004**: 系統 MUST 在頂部工具列提供上一篇和下一篇按鈕以切換文章
- **FR-005**: 系統 MUST 為每篇文章生成唯一的、可分享的直接連結
- **FR-006**: 系統 MUST 支援通過直接 URL 訪問特定文章（例如：`/newsletter/2025-w42/article/5`）
- **FR-007**: 系統 MUST 清楚顯示讀者當前正在查看的文章位置（例如：「第 5 篇，共 10 篇」）
- **FR-008**: 系統 MUST 提供文章清單，讀者可在其中直接點擊選擇任何文章
- **FR-009**: 系統 MUST 禁用或視覺化隱藏不可用的導航按鈕（例如：在最後一篇文章時禁用下一篇按鈕）
- **FR-010**: 系統 MUST 支援編輯者管理某週內文章的順序（拖拽或上下移動）
- **FR-011**: 系統 MUST 允許編輯者從周報中新增或移除文章
- **FR-012**: 系統 MUST 保存編輯者的所有內容變更（文章順序、新增、刪除）並立即在讀者端反映
- **FR-013**: 系統 MUST 對文章清單中缺失的周份或無內容的情況提供適當的錯誤處理及用戶反饋

### 關鍵實體

- **電子報周份 (Newsletter Week)**: 代表電子報的特定一週發行，包含周號、發行日期、文章清單
  - 屬性：周號（例如：2025-W42）、發行日期、建立日期、最後修改日期
  - 關係：包含多篇文章；可能有多個版本（如果支援歷史記錄）

- **文章 (Article)**: 電子報中的單篇內容，具有唯一身份和位置
  - 屬性：文章 ID、標題、內容、作者、建立日期、排序序號、週份 ID、唯一連結 URL
  - 關係：屬於一個特定週份；有獨立的可訪問連結

- **導航狀態 (Navigation State)**: 追蹤讀者當前的瀏覽位置
  - 屬性：當前周份 ID、當前文章 ID、總文章數、當前位置（第 X 篇，共 Y 篇）
  - 關係：根據使用者訪問的 URL 或點擊的導航按鈕更新

## 成功標準 *(必須)*

### 可衡量的成果

- **SC-001**: 讀者可在 2 秒內完成從一篇文章切換到另一篇文章（包括所有導航方法）
- **SC-002**: 90% 的讀者能夠通過直接連結成功訪問特定文章，無需額外導航步驟
- **SC-003**: 讀者對應用程式導航清晰度的滿意度達到 85% 以上（根據使用者反饋或調查）
- **SC-004**: 編輯者能夠在 5 分鐘內重新排列某週內最多 50 篇文章
- **SC-005**: 系統支援同時顯示週報清單及當前文章內容，不造成視覺混亂
- **SC-006**: 應用程式在桌面和行動裝置上的導航體驗一致，可用性相同
- **SC-007**: 99.5% 的直接連結應在首次訪問時正確打開相應的文章

## 澄清

### Session 2025-10-28

- Q1: 編輯者角色與權限模型 → A: 單一編輯者角色，所有編輯者擁有相同權限，可修改任何週報內容
- Q2: 文章內容格式 → A: Markdown 格式（編輯者撰寫 Markdown，系統渲染為 HTML）
- Q3: 文章切換時的載入狀態 → A: 顯示載入指示器（旋轉圖標），隱藏舊內容直到新文章完全加載
- Q4: 並行編輯衝突解決 → D: 不處理衝突，最後保存的版本覆蓋前一版本
- Q5: 週份編輯時間窗口 → A: 無時間限制，編輯者可任何時間編輯任何週份（過去、現在、未來）

## 假設條件與設計決策

### 假設條件

- **身份驗證**: 讀者可以匿名存取週報；編輯者需要登入進行管理操作
- **編輯者角色**: 單一編輯者角色，所有經驗證的編輯者擁有完整權限，可新增/修改/刪除任何週報的文章
- **文章內容格式**: 文章內容採用 Markdown 格式儲存，系統自動轉換為 HTML 渲染
- **並行編輯**: 系統不處理衝突；最後保存的變更覆蓋前一版本，編輯者應協調
- **編輯時間窗口**: 編輯者可任何時間編輯任何週份（過去、現在、未來），無時間限制或發行狀態鎖定
- **版本控制**: 系統不需要追蹤文章的歷史版本；只維護最新版本
- **時區**: 所有時間戳記使用 UTC 或專案指定的統一時區
- **搜索功能**: 暫不包含全文搜索；讀者只能通過周份和位置訪問文章

### 設計決策

- **無身份驗證讀者**: 為了最大化可訪問性，讀者不需要登入即可查看文章
- **簡潔導航**: 提供多種導航方法（邊緣按鈕、工具列、直接連結）以適應不同偏好
- **獨立文章連結**: 每篇文章都有不可變的唯一 URL，方便在電子郵件和社群媒體中分享
- **實時更新**: 編輯者的內容變更應立即對讀者可見（無需快取延遲）
